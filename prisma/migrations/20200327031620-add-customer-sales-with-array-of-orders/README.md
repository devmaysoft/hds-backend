# Migration `20200327031620-add-customer-sales-with-array-of-orders`

This migration has been generated by Mina Saleeb at 3/27/2020, 3:16:20 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `hds`.`CustomerSale` (
    `customerId` int NOT NULL ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `saleAmount` int NOT NULL DEFAULT 0 ,
    `saleDate` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `hds`.`CustomerOrder` ADD COLUMN `customerSale` int  ;

ALTER TABLE `hds`.`Product` ADD COLUMN `customerSale` int  ;

ALTER TABLE `hds`.`CustomerSale` ADD FOREIGN KEY (`customerId`) REFERENCES `hds`.`Customer`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `hds`.`CustomerOrder` ADD FOREIGN KEY (`customerSale`) REFERENCES `hds`.`CustomerSale`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `hds`.`Product` ADD FOREIGN KEY (`customerSale`) REFERENCES `hds`.`CustomerSale`(`id`) ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200327030531-remove-customer-sales..20200327031620-add-customer-sales-with-array-of-orders
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource mysql {
   provider = "mysql"
-  url = "***"
+  url      = env("MYSQL_URL")
 }
 generator client {
   provider      = "prisma-client-js"
@@ -129,8 +129,17 @@
   extendedCost      Int
   dueDate           DateTime
 }
+model CustomerSale {
+  id              Int           @id @default(autoincrement())
+  customerId      Customer
+  customerOrderId CustomerOrder[]
+  productId       Product[]
+  saleDate        DateTime      @default(now())
+  saleAmount      Int
+}
+
 model Bid {
   id            Int      @id @default(autoincrement())
   customerId    Customer
   requiredHours Int
```


